setwd("C:/Users/Gerhard Viljoen/Desktop/MSc-thesis/R")
knitr::opts_chunk$set(echo = TRUE,message = F,warning = F)
require(jsonlite)
dat <- fromJSON("data/text.txt")
zero <- dat[[1]]
one <- dat[[2]]
two <- dat[[3]]
three <- dat[[4]]
all.dat <- data.frame(
rbind(
zero,
one,
two,
three
)
)
require(dplyr)
library(tidyr)
#isolate the layer columns
layers <- data.frame(all.dat[,c(8,12,16,20,24,28)])
#choose an example that is not null
fix <- layers[6,1]
#fill it with zeros, retaining its shape
for(i in 1:nrow(fix[[1]])){
for(j in 1:ncol(fix[[1]])){
fix[[1]][i,j] <- 0
}
}
#replace any null values with this matrix of zeroes
nullToNA <- function(x) {
x[sapply(x, is.null)] <- fix
return(x)
}
layers <- as.matrix(layers)
layers <- nullToNA(layers)
layers <- cbind(all.dat[,1:3],layers)
#unnest each layer individually:
#//TODO: create a function for this
#LAYER 0
a <- rep(NA,264)
for(i in layers$layer0){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(all.dat[,c(1:7,9:11,13:15,17:19,21:23,25:27)],a)
#LAYER 1
a <- rep(NA,264)
for(i in layers$layer1){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(layer0,a)
#LAYER 2
a <- rep(NA,264)
for(i in layers$layer2){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(layer0,a)
#LAYER 3
a <- rep(NA,264)
for(i in layers$layer3){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(layer0,a)
#LAYER 4
a <- rep(NA,264)
for(i in layers$layer4){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(layer0,a)
#LAYER 5
a <- rep(NA,264)
for(i in layers$layer5){
add <- as.vector(unlist(i))
a <- rbind(a,add)
}
a <- a[-1,]
layer0 <- cbind(layer0,a)
#make all missing values 0
layer0[is.na(layer0)] <- 0
my.dat <- layer0[,4:100]
#make the outcome variable categorical
my.dat$pdgCode <- as.factor(my.dat$pdgCode)
#save the manipulated dataset and clear the R environment
save(my.dat,file="NNdata.RData")
rm(list=ls())
#load the manipulated data set
load("NNdata.RData")
#scale numerical predictor variables
my.dat[,-1] <- scale(my.dat[,-1])
my.dat <- my.dat %>%
subset(pdgCode!=-11) %>%
subset(pdgCode!=11)
