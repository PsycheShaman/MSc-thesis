---
title: "Final thesis plots and fixes"
author: "Gerhard Viljoen"
date: "05/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list=ls())
load("C:/Users/Gerhard/Documents/msc-thesis-data/aux_.rdata")
load("C:/Users/Gerhard/Documents/msc-thesis-data/meta.rdata")
load("C:/Users/Gerhard/Documents/msc-thesis-data/y.rdata")
```


```{r}
names(aux)
names(meta)
```


```{r}
y <- data.frame(y)
pt_pid <- data.frame(cbind(aux$P,aux$PT,ifelse(y$y==0,"pion","electron")))
head(pt_pid)
pt_pid$X1 <- as.numeric(as.character(pt_pid$X1))
pt_pid$X2 <- as.numeric(as.character(pt_pid$X2))
pt_pid$X3 <- as.factor(unlist(pt_pid$X3))
names(pt_pid) <- c("P","Pt","Particle ID")
```

```{r}
n = 12
h1 <- hist(pt_pid$Pt[as.character(pt_pid$`Particle ID`)=="electron"],breaks=n)
           # breaks = c(1.5,2.5,3.5,4.5,5.5,6.5))
h2 <- hist(pt_pid$Pt[as.character(pt_pid$`Particle ID`)=="pion"],breaks=n)
           # breaks=c(1.5,2.5,3.5,4.5,5.5,6.5))

h1$mids==h2$mids

x_elec = h1$mids
x_pion = h2$mids

y_elec = h1$counts
y_pion = h2$counts

df1 <- data.frame(cbind(x_elec,y_elec))
df2 <- data.frame(cbind(x_pion,y_pion))

names(df1) <- names(df2) <- c("Pt","counts")

df <- rbind(df1,df2)
df$`Particle ID` <- c(rep("electron",length(x_elec)),rep("pion",length(x_pion)))

require(ggplot2)
require(latex2exp)

fancy_scientific <- function(l) {
     l <- format(l, scientific = TRUE)
     l <- gsub("^(.*)e", "'\\1'e", l)
     l <- gsub("e", "%*%10^", l)
     parse(text=l)
}

require(extrafont)
# font_import()
# loadfonts(device = "win")

# windowsFonts()

ggplot(data=df,aes(x=Pt,y=counts,color=`Particle ID`))+xlab(TeX("$\\textit{p}_T (GeV/\\textit{c})$"))+geom_point()+
scale_y_continuous(trans='log10',labels = fancy_scientific,limits=c(10^0, 10^7))+
  theme( axis.title.x =element_text(size=12,  family="serif"))+ylab(TeX("N (log_{10} scale)"))+
  theme( axis.title.y =element_text(size=12,  family="serif"))+geom_errorbar(ymin=df$counts+
                                                                               sqrt(df$counts),
                                                                             ymax=df$counts-sqrt(df$counts))+
  geom_errorbarh(aes(xmin=df$Pt-0.25,xmax=df$Pt+0.25))+theme(legend.position = c(0.9, 0.9),legend.text = 
                                                             element_text(size=12,  family="serif"),
                                                           legend.title = element_text(size=12,  family="serif"))+ theme( axis.line = element_line(colour = "black", 
                      size = 0.5, linetype = "solid"))+theme(axis.text = element_text(color = "black"))+
  theme(panel.background = element_rect(fill="white",color="white",size=0.01))+
  theme(panel.grid.major = element_line(size = 0.1, linetype = 'solid',colour = "gray90"))+
  theme(panel.grid.minor = element_line(size = 0.1, linetype = 'dashed',colour = "gray90"))+
  theme(legend.box.background = element_rect(colour = "black"),
        legend.background = element_blank(),legend.key = element_blank())
  

# scale_y_log10() geom_step()+ +geom_point()

ggplot(data=data.frame(cbind(h1$mids,h2$counts/h1$counts)),aes(x=h1$mids,y=h2$counts/h1$counts))+geom_point()+
  ggtitle(element_blank())+xlab(TeX("\\textit{p}_T (GeV/\\textit{c})"))+ylab(TeX('Relative $\\,\\pi$ abundance: $\\,\\,(\\frac{N_{\\pi}}{N_e},\\,\\,log_{10}\\,scale)$'))+scale_y_continuous(trans='log10',limits=c(.1, 30))+
  geom_errorbar(aes(ymin=(h2$counts/h1$counts)-sqrt(h2$counts/h1$counts),ymax=(h2$counts/h1$counts)+sqrt(h2$counts/h1$counts),width=.05))+
  geom_errorbarh(aes(xmin=h1$mids-0.25,xmax=h1$mids+0.25))+
  theme( axis.title.x =element_text(size=12,  family="serif"))+
  theme( axis.title.y =element_text(size=12,  family="serif"))+
  theme(panel.grid.major = element_line(size = 0.1, linetype = 'solid',colour = "gray90"))+
  theme(panel.grid.minor = element_line(size = 0.1, linetype = 'dashed',colour = "gray90"))+ theme( axis.line = element_line(colour = "black", 
                      size = 0.5, linetype = "solid"))+theme(axis.text = element_text(color = "black"))+
  theme(panel.background = element_rect(fill="white",color="white",size=0.01))

```
























