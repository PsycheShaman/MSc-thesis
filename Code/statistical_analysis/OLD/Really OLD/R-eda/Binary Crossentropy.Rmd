---
title: "Binary Cross Entropy"
author: "Gerhard Viljoen"
date: "1/18/2019"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#For binary classification:

```{r}
cross.entropy <- function(y,p){
  -(y * log(p,base = 10) + ((1-y)*(1 - log(1-p,base=10))))
}

#if the predicted class is 1:

y <- 1

p <- seq(0,1,0.01)

loss <- cross.entropy(y,p)

cross.entropy <- function(y,p){
  -(y * log(p,base = 10) + ((1-y)*(1 - log(1-p,base=10))))
}

loss2 <- cross.entropy(y=1,rev(p))

require(latex2exp)

plot(x=p,y=loss,  col="purple",cex=0.5, main =
       TeX("L(y,$\\hat{y}$) = -(y . log($\\hat{y}$) + (1-y) .log(1-$\\hat{y}$)))"),ylab = "Binary Cross Entropy Loss", xlab = TeX("$\\hat{y}$"),family="serif",type="l",lwd=2)
lines(x=p,y=loss2, col="cornflowerblue",lwd=2)
text(x=.15,y=1,"y=1",col="purple")
text(x=.85,y=1,"y=0",col="cornflowerblue")
```

