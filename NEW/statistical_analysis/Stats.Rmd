---
title: "Statistical Analyses"
author: "Gerhard Viljoen"
date: "05/09/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list=ls())


load("C:/Users/Gerhard/Documents/msc-thesis-data/aux_.rdata")
load("C:/Users/Gerhard/Documents/msc-thesis-data/meta.rdata")
load("C:/Users/Gerhard/Documents/msc-thesis-data/x.rdata")
load("C:/Users/Gerhard/Documents/msc-thesis-data/y.rdata")
```

```{r}
dim(x) <- c(dim(x)[1],17,24)

cs <- apply(x,1,colSums)

```


```{r}
names(meta)
names(aux)

meta <- data.frame(meta,aux,y)

rm(aux,y)

names(meta)


fac_cols <- c(4,5,6,7,13)

for(i in fac_cols){
  meta[,i] <- as.factor(meta[,i])
}

non_fac_cols <- 1:ncol(meta)[-fac_cols]

for(i in non_fac_cols){
  meta[,i] <- as.numeric(meta[,i])
}

```

```{r}
t <- data.frame(table(meta$y))

names(t)[1] <- "Particle ID"

t$`Particle ID` <- c("pion","electron")

t$Percent <- c(round(t$Freq[1]/sum(t$Freq)*100,2),round(t$Freq[2]/sum(t$Freq)*100,2))

require(ggplot2)

ggplot(t,aes(x=`Particle ID`, y= `Freq`,fill=`Particle ID`))+geom_bar(stat = "identity")+geom_text(label=c(paste0(t$Freq[1],"\n (",t$Percent[1],"%)"),paste0(t$Freq[2],"\n (",t$Percent[2],"%)")))

```


```{r}

library("RColorBrewer")

meta$y <- ifelse(as.numeric(as.character(meta$y))==1,"electron","pion")

# table(meta$y)

meta$y <- ifelse(as.character(meta$y)=="electron","pion","electron")

myPalette <- colorRampPalette((brewer.pal(11, "Spectral")))
sc <- scale_colour_gradientn(colours = myPalette(100), limits=c(0, 100))

# table(meta$dEdX,meta$P)

install.packages("hexbin")

ggplot(meta,aes(y=dEdX,x=P))+geom_hex(bins=1000)+facet_wrap(~y)+xlab("Momentum (GeV/c)")+ylab("dE/dX (Arbitrary Units)")

ggplot(meta,aes(y=dEdX,x=PT))+geom_hex(bins=1000)+facet_wrap(~y)+xlab("Transverse Momentum (P_T) (GeV/c)")+ylab("dE/dX (Arbitrary Units)")
```


```{r}
cs <- cbind(cs,meta$y)



cs1 <- rowMeans(cs)

ggplot(data.frame(cs1),aes(x=1:24,y=cs1))+geom_line()
```





































